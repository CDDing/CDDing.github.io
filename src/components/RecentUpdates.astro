---
import type { Update } from '../data/updates';
import { updates } from '../data/updates';

interface Props {
  category?: Update['category'];
}

const { category } = Astro.props;

const filtered = category
  ? updates.filter((u) => u.category === category)
  : updates;

const sorted = [...filtered].sort(
  (a, b) => new Date(b.date).getTime() - new Date(a.date).getTime(),
);

---

<section class="recent-updates">
  <h2>최근 업데이트</h2>
  <ul class="update-list">
    {sorted.map((item) => (
      <li class="update-item">
        <span class={`category-badge badge-${item.category}`}>
          {item.source}
        </span>
        <a href={item.href} class="update-link">{item.title}</a>
        <time datetime={item.date}>
          {item.date.slice(5).replaceAll('-', '.')}
        </time>
      </li>
    ))}
  </ul>
</section>
