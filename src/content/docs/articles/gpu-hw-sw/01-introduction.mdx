---
title: Introduction of GPU (GPU ì†Œê°œ) â€” í•œê¸€ ì •ë¦¬
description: Georgia Tech CS8803 Module 1 â€” GPU ê¸°ì´ˆ, ë³‘ë ¬ í”„ë¡œì„¸ì„œ íŒ¨ëŸ¬ë‹¤ì„, GPU ì•„í‚¤í…ì²˜ ê°œìš”, GPU ë°œì „ì‚¬
---

> **ì›ë¬¸:** [CS8803 OMSCS â€” GPU Hardware and Software Notes (Module 1)](https://lowyx.com/posts/gt-gpu-notes/#module-1-introduction-of-gpu)

## í•™ìŠµ ëª©í‘œ

- GPUì˜ ê¸°ë³¸ ë°°ê²½ì„ ì„¤ëª…í•œë‹¤
- ë°ì´í„° ë³‘ë ¬ ì•„í‚¤í…ì²˜ì˜ ê¸°ë³¸ ê°œë…ì„ ì´í•´í•œë‹¤

**í•„ìˆ˜ ìë£Œ:** [CUDA Programming Guide, Section 1-2, 4](https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html) / [Performance Analysis and Tuning for GPGPU (Chapter 1)](https://galileo-gatech.primo.exlibrisgroup.com/discovery/fulldisplay?context=L&context=L&vid=01GALI_GIT:GT&vid=01GALI_GIT&docid=cdi_proquest_ebookcentral_EBC1092425&tab=default_tab&lang=en)

**ì„ íƒ ìë£Œ:** [Patterns for Parallel Programming (Chapter 2)](https://galileo-gatech.primo.exlibrisgroup.com/discovery/fulldisplay?docid=cdi_askewsholts_vlebooks_9780321630582&context=PC&vid=01GALI_GIT:GT&lang=en&adaptor=Primo%20Central)

---

## Lesson 1: GPUë€ ë¬´ì—‡ì¸ê°€

### GPU vs CPU

GPUê°€ ì™œ ì˜¤ëŠ˜ë‚  ì¤‘ìš”í•œê°€? GPUëŠ” ì²˜ìŒì— 3D ê·¸ë˜í”½ìœ¼ë¡œ ì£¼ëª©ë°›ì•˜ì§€ë§Œ, ì´í›„ ê°•ë ¥í•œ ë³‘ë ¬ í”„ë¡œì„¸ì„œë¡œ ë°œì „í•˜ì˜€ë‹¤. ì˜¤ëŠ˜ë‚  GPUëŠ” ML ê°€ì†ê¸° ë° ê³ ì„±ëŠ¥ ì»´í“¨íŒ…ê³¼ ìì£¼ ì—°ê´€ë˜ë©° ê·¸ ë‹¤ì¬ë‹¤ëŠ¥í•¨ì„ ë³´ì—¬ ì¤€ë‹¤.

CPUì™€ GPUì˜ í•µì‹¬ ì°¨ì´ëŠ” ëŒ€ìƒ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ìˆë‹¤.

- **CPU**: ë‹¨ì¼ ìŠ¤ë ˆë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ë§ì¶”ì–´ì ¸ ìµœëŒ€ ì†ë„ë¥¼ ëª©í‘œë¡œ í•œë‹¤. ì •í™•í•œ ì˜ˆì™¸ ì²˜ë¦¬(precise exception)ë¥¼ ìš°ì„ ì‹œí•˜ë©°, ì´ëŠ” í”„ë¡œê·¸ë¨ ì •í™•ì„±ê³¼ ë””ë²„ê¹…ì— ì¤‘ìš”í•˜ë‹¤.
- **GPU**: ë³‘ë ¬ ì²˜ë¦¬ì— íŠ¹í™”ë˜ì–´ ìˆ˜ë§ì€ ìŠ¤ë ˆë“œë¥¼ ë™ì‹œì— ì²˜ë¦¬í•œë‹¤. ì •í™•í•œ ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ ì¤‘ì‹œí•˜ì§€ ì•Šìœ¼ë©°, OS ë° I/O ì—°ì‚°ì„ ìœ„í•œ ì „ìš© í•˜ë“œì›¨ì–´ë¥¼ í™œìš©í•œë‹¤. CPUê°€ í˜¸ìŠ¤íŠ¸, GPUê°€ ê°€ì†ê¸°ë¡œ ë™ì‘í•˜ëŠ” êµ¬ì¡°ê°€ ìì—°ìŠ¤ëŸ½ê²Œ í˜•ì„±ëœë‹¤.

ğŸ“ **í•™ìŠµ ë¡œê·¸**: [Precise Exception â€” CPU vs GPU](/log/misc/gpu_architecture/#precise-exception--cpu-vs-gpu "CPUëŠ” ì™œ precise exceptionì´ í•„ìˆ˜ì´ê³ , GPUëŠ” ì™œ impreciseë¥¼ ì„ íƒí–ˆëŠ”ê°€")

### GPU ISA

ISA(Instruction Set Architecture)ëŠ” ëª…ë ¹ì–´ ì§‘í•© ì•„í‚¤í…ì²˜ë¥¼ ì˜ë¯¸í•œë‹¤.

- **CPU**: ê³µê°œ(open) ISAë¥¼ ì‚¬ìš©í•˜ì—¬ í•˜ë“œì›¨ì–´ í”Œë«í¼ ê°„ ì†Œí”„íŠ¸ì›¨ì–´ í˜¸í™˜ì„±ì„ ë³´ì¥í•œë‹¤.
- **GPU**: ê°€ì†ê¸° ëª¨ë“œë¡œ ë™ì‘í•˜ë©°, ë“œë¼ì´ë²„ê°€ í•˜ë‚˜ì˜ ISAì—ì„œ íŠ¹ì • í•˜ë“œì›¨ì–´ìš© ISAë¡œ ì½”ë“œë¥¼ ë³€í™˜í•œë‹¤. PTXëŠ” ê³µê°œ ê°€ìƒ ISAë¡œ ë„ì…ë˜ì—ˆë‹¤.

ğŸ“ **í•™ìŠµ ë¡œê·¸**: [ê°€ì†ê¸° ëª¨ë“œì™€ PTX](/log/misc/gpu_architecture/#ê°€ì†ê¸°-ëª¨ë“œì™€-ptx "GPUê°€ ê°€ì†ê¸°ë¡œ ë™ì‘í•˜ëŠ” ì´ìœ ì™€ PTX ê°€ìƒ ISAì˜ ì—­í• ")

| | CPU | GPU |
|---|---|---|
| ëŒ€ìƒ ì• í”Œë¦¬ì¼€ì´ì…˜ | ì§€ì—° ì‹œê°„(latency)ì— ë¯¼ê° | ì²˜ë¦¬ëŸ‰(throughput)ì— ë¯¼ê° |
| ì •í™•í•œ ì˜ˆì™¸ ì²˜ë¦¬ | ì§€ì› | ë¯¸ì§€ì› |
| ì—­í•  | í˜¸ìŠ¤íŠ¸ | ê°€ì†ê¸° |
| ISA | ê³µê°œ | ê³µê°œ/ë¹„ê³µê°œ |
| í”„ë¡œê·¸ë˜ë° ëª¨ë¸ | SISD/SIMD | SPMD |

### SIMD vs SPMD

- **SISD** â€” Single Instruction, Single Data
- **SIMD** â€” Single Instruction, Multiple Data: ê°™ì€ ëª…ë ¹ì–´ë¥¼ ë™ì‹œì— ì„œë¡œ ë‹¤ë¥¸ ë°ì´í„°ì— ì ìš©í•œë‹¤. ì´ë¯¸ì§€ ì²˜ë¦¬, ë²¡í„° ì—°ì‚° ë“± ë°ì´í„° ë³‘ë ¬ ì‘ì—…ì— ì í•©í•˜ë‹¤. ì¼ê´€ëœ êµ¬ì¡°ì˜ ë°ì´í„°ê°€ í•„ìš”í•˜ë©°, ë¶„ê¸°/ì¡°ê±´ ë¡œì§ì—ì„œ ë¡ìŠ¤í…(lockstep) ì‹¤í–‰ìœ¼ë¡œ ì¸í•œ ì œì•½ì´ ìˆë‹¤.
- **SPMD** â€” Single Program, Multiple Data: ê°™ì€ í”„ë¡œê·¸ë¨ì„ ê°ìì˜ ë°©ì‹ìœ¼ë¡œ ì„œë¡œ ë‹¤ë¥¸ ë°ì´í„°ì— ì ìš©í•œë‹¤. SIMDë³´ë‹¤ ìœ ì—°í•˜ë©° ë¶„ê¸°ì™€ ì¡°ê±´ ë¡œì§ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤. ë³µì¡í•œ ì›Œí¬í”Œë¡œì™€ ë¶„ì‚° ì»´í“¨íŒ…ì— ì£¼ë¡œ ì‚¬ìš©ëœë‹¤. ë‹¤ë§Œ ìŠ¤ë ˆë“œ ê´€ë¦¬ì™€ í†µì‹  ì˜¤ë²„í—¤ë“œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.

GPUì˜ í”„ë¡œê·¸ë˜ë° ëª¨ë¸ì€ SPMD ëª¨ë¸ë¡œ, ë³‘ë ¬ ì²˜ë¦¬ë¥¼ ê°•ì¡°í•œë‹¤.

---

## Lesson 2: í˜„ëŒ€ í”„ë¡œì„¸ì„œ íŒ¨ëŸ¬ë‹¤ì„

### CPU íŒŒì´í”„ë¼ì¸ ê¸°ì´ˆ

CPU ì„¤ê³„ì˜ ê¸°ì´ˆëŠ” ë‹¤ìŒ ë‹¨ê³„ë¡œ êµ¬ì„±ëœë‹¤:

1. **Fetch (ì¸ì¶œ)** â€” I-cacheì—ì„œ ëª…ë ¹ì–´ë¥¼ ì¸ì¶œí•œë‹¤.
2. **Decode (ë””ì½”ë“œ)** â€” ëª…ë ¹ì–´ë¥¼ í•´ë…í•œë‹¤. x86ì˜ ê²½ìš° í•˜ë‚˜ì˜ ëª…ë ¹ì–´ê°€ ì—¬ëŸ¬ micro-uopì„ ìƒì„±í•œë‹¤.
3. **Register Read (ë ˆì§€ìŠ¤í„° ì½ê¸°)** â€” ë””ì½”ë“œ í›„ ë ˆì§€ìŠ¤í„° íŒŒì¼ì— ì ‘ê·¼í•œë‹¤.
4. **Schedule (ìŠ¤ì¼€ì¤„)** â€” ì‹¤í–‰í•  ëª…ë ¹ì–´ë¥¼ ì„ íƒí•œë‹¤.
   - In-order í”„ë¡œì„¸ì„œ: í”„ë¡œê·¸ë¨ ìˆœì„œëŒ€ë¡œ ì„ íƒí•œë‹¤.
   - Out-of-order í”„ë¡œì„¸ì„œ: ì¤€ë¹„ëœ ëª…ë ¹ì–´ë¥¼ ìˆœì„œ ë¬´ê´€í•˜ê²Œ ì„ íƒí•˜ì—¬ ë” ë§ì€ ëª…ë ¹ì–´ë¥¼ ë³‘ë ¬ ì‹¤í–‰í•œë‹¤.
5. **Execute (ì‹¤í–‰)** â€” ì‹¤ì œ ì—°ì‚° ìˆ˜í–‰ ë˜ëŠ” ë©”ëª¨ë¦¬ ì ‘ê·¼í•œë‹¤.
6. **Write-back (ì“°ê¸°)** â€” ê²°ê³¼ë¥¼ ê¸°ë¡í•œë‹¤.

**ìŠˆí¼ìŠ¤ì¹¼ë¼(Superscalar) í”„ë¡œì„¸ì„œ**ëŠ” í•˜ë‚˜ ì´ìƒì˜ ëª…ë ¹ì–´ë¥¼ ë™ì‹œì— ì¸ì¶œÂ·ë””ì½”ë“œÂ·ì‹¤í–‰í•˜ì—¬ CPU ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¨ë‹¤.

### ëª…ë ¹ì–´ ìˆ˜ì¤€ ë³‘ë ¬ì„± (ILP)

ìŠˆí¼ìŠ¤ì¹¼ë¼ í”„ë¡œì„¸ì„œëŠ” ëª…ë ¹ì–´ ìˆ˜ì¤€ ë³‘ë ¬ì„±(ILP, Instruction Level Parallelism)ì„ ë†’ì¸ë‹¤. ILPëŠ” CPU ì„±ëŠ¥ì˜ í•µì‹¬ì´ë©°, í”„ë¡œì„¸ì„œê°€ ë…ë¦½ì ì¸ ëª…ë ¹ì–´ë¥¼ ì°¾ì•„ íš¨ìœ¨ì„ í–¥ìƒì‹œí‚¨ë‹¤. ìŠˆí¼ìŠ¤ì¹¼ë¼ì—ì„œ IPC(Instructions Per Cycle)ëŠ” 1ë³´ë‹¤ í¬ë‹¤.

- **ë…ë¦½ ëª…ë ¹ì–´**: ì„œë¡œì˜ ê²°ê³¼ì— ì˜ì¡´í•˜ì§€ ì•Šìœ¼ë©´ ë™ì‹œ ì‹¤í–‰ì´ ê°€ëŠ¥í•˜ë‹¤.
- **ì˜ì¡´ ëª…ë ¹ì–´**: ì˜ì¡´ì„±ì´ ìˆìœ¼ë©´ ìˆœì°¨ ì‹¤í–‰í•´ì•¼ í•œë‹¤.

Out-of-order í”„ë¡œì„¸ì„œëŠ” ë…ë¦½ì ì¸ ëª…ë ¹ì–´ë¥¼ ë” ë§ì´ ì°¾ì•„ë‚´ì–´ ILPë¥¼ í–¥ìƒì‹œí‚¨ë‹¤. ILP í–¥ìƒì€ CPU ì„¤ê³„ì˜ ì£¼ìš” ì´ˆì  ì¤‘ í•˜ë‚˜ì´ë‹¤.

### CPU ì„±ëŠ¥ í–¥ìƒ ë°©ë²•

1. **ê¹Šì€ íŒŒì´í”„ë¼ì¸** â€” ì£¼íŒŒìˆ˜ë¥¼ ë†’ì´ì§€ë§Œ, ë” ì •í™•í•œ ë¶„ê¸° ì˜ˆì¸¡ì´ í•„ìš”í•˜ë‹¤.
2. **í° ìºì‹œ** â€” ìºì‹œ ë¯¸ìŠ¤ë¥¼ ì¤„ì—¬ ë©”ëª¨ë¦¬ ì ‘ê·¼ ì‹œê°„ì„ í¬ê²Œ ë‹¨ì¶•í•œë‹¤.

### ë©€í‹°ìŠ¤ë ˆë”©

ë©€í‹°ìŠ¤ë ˆë”©ì€ ì—¬ëŸ¬ ìŠ¤ë ˆë“œë¥¼ í™œì„±í™”í•˜ì—¬ CPU ì„±ëŠ¥ì„ ë†’ì¸ë‹¤. ë‹¤ë¥¸ ìŠ¤ë ˆë“œë¡œ ì „í™˜í•˜ì—¬ ì¤€ë¹„ëœ ëª…ë ¹ì–´ë¥¼ ë” ë§ì´ ê²€ì‚¬í•  ìˆ˜ ìˆë‹¤. ë©€í‹°ìŠ¤ë ˆë”©ì€ ê³ ì„±ëŠ¥ GPUì˜ í•µì‹¬ ìš”ì†Œì´ë©°, ë¹„êµì  ì ì€ í•˜ë“œì›¨ì–´ ìì›ìœ¼ë¡œ êµ¬í˜„ ê°€ëŠ¥í•˜ë‹¤.

### ë©€í‹°í”„ë¡œì„¸ì„œ

ì „ì²´ ìì›ì„ ëŠ˜ë ¤ ë§ì€ í”„ë¡œì„¸ì„œë¥¼ ë³´ìœ í•˜ëŠ” ë°©ë²•ì´ë‹¤. CPUì™€ GPU ëª¨ë‘ì—ì„œ ë„ë¦¬ ì‚¬ìš©ëœë‹¤.

---

## Lesson 3: ë³‘ë ¬ í”„ë¡œê·¸ë¨ ì‘ì„±ë²•

### Amdahlì˜ ë²•ì¹™

ë³‘ë ¬ í”„ë¡œê·¸ë˜ë°ì˜ ê¸°ë³¸ ê°œë…ì¸ Amdahlì˜ ë²•ì¹™ì´ë‹¤. ì„±ëŠ¥ í–¥ìƒ(Speedup)ì€ ë‹¤ìŒê³¼ ê°™ì´ ê³„ì‚°ëœë‹¤:

```
Speedup = 1 / (P/N + S)

P: ë³‘ë ¬í™” ê°€ëŠ¥ ë¹„ìœ¨
S: ì§ë ¬ êµ¬ê°„
N: í”„ë¡œì„¸ì„œ ìˆ˜
```

ë³‘ë ¬ì„±ì´ ì¶©ë¶„í•˜ê³  ì§ë ¬ êµ¬ê°„ì´ ìµœì†Œì´ë©´, í”„ë¡œì„¸ì„œ ìˆ˜ì— ë”°ë¼ ì„±ëŠ¥ì´ ê±°ì˜ ì„ í˜•ìœ¼ë¡œ í™•ì¥ëœë‹¤. ê·¸ëŸ¬ë‚˜ ì§ë ¬ êµ¬ê°„ì´ ì»¤ì§€ë©´ í™•ì¥ì„±ì´ ê¸‰ê²©íˆ ì €í•˜ëœë‹¤. **ì§ë ¬ ë¹„ìœ¨ì´ 10%ë§Œ ë˜ì–´ë„ ë³‘ë ¬í™”ì˜ ì´ì ì´ í¬ê²Œ ì œí•œëœë‹¤.**

### íƒœìŠ¤í¬ ë¶„í•´ vs ë°ì´í„° ë¶„í•´

ë°°ì—´ ë§ì…ˆê³¼ ìµœì†Œ/ìµœëŒ€ê°’ ì°¾ê¸°ë¥¼ ì˜ˆë¡œ ë“¤ì–´ ë³´ì.

**íƒœìŠ¤í¬ ë¶„í•´(Task Decomposition):**
- í•œ ì½”ì–´ëŠ” ë§ì…ˆì„ ìˆ˜í–‰í•˜ê³ , ë‹¤ë¥¸ ì½”ì–´ëŠ” ìµœì†Œ/ìµœëŒ€ ì—°ì‚°ì„ ìˆ˜í–‰í•œë‹¤.
- ë°°ì—´ AëŠ” ë‘ ì½”ì–´ ëª¨ë‘ì— ì „ì†¡ë˜ì–´ì•¼ í•œë‹¤.

**ë°ì´í„° ë¶„í•´(Data Decomposition):**
- ë°ì´í„°ë¥¼ ë‘ ì½”ì–´ë¡œ ë¶„í• í•œë‹¤.
- í•©ê³„ì™€ ìµœì†Œ/ìµœëŒ€ ëª¨ë‘ì— ëŒ€í•´ ë¦¬ë•ì…˜(reduction) ì—°ì‚°ì´ í•„ìš”í•˜ë‹¤.

### Flynnì˜ ë¶„ë¥˜ë²•

| ë¶„ë¥˜ | ì˜ë¯¸ |
|------|------|
| SISD | Single Instruction, Single Data |
| SIMD/SIMT | Single Instruction, Multiple Data / Thread |
| MISD | Multiple Instruction, Single Data (ì‹¤ì§ˆì ìœ¼ë¡œ ë“œë¬¼ë‹¤) |
| MIMD | Multiple Instruction, Multiple Data |

- **CPU**: SISD, SIMD, MIMDê°€ ë  ìˆ˜ ìˆë‹¤. ë²¡í„° ì²˜ë¦¬ ìœ ë‹›ìœ¼ë¡œ SIMDë¥¼ ì‚¬ìš©í•œë‹¤.
- **GPU**: ì¼ë°˜ì ìœ¼ë¡œ SIMTì´ë‹¤. ë§ì€ ALU(ì‚°ìˆ  ë…¼ë¦¬ ì¥ì¹˜) ìœ ë‹›ì„ ê°–ëŠ”ë‹¤.
- SIMDì™€ SIMTì˜ ì°¨ì´ëŠ” ì´í›„ ëª¨ë“ˆì—ì„œ ë…¼ì˜í•œë‹¤.

### SPMD í”„ë¡œê·¸ë˜ë°

GPUì˜ ì¼ë°˜ì ì¸ í”„ë¡œê·¸ë˜ë° íŒ¨í„´ì´ë‹¤.

- ëª¨ë“  ì½”ì–´(ìŠ¤ë ˆë“œ)ê°€ ê°™ì€ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•˜ë˜ ì„œë¡œ ë‹¤ë¥¸ ë°ì´í„°ì— ëŒ€í•´ ë™ì‘í•œë‹¤.
- ë°ì´í„° ë¶„í•´ê°€ SPMDì˜ ì „í˜•ì ì¸ í”„ë¡œê·¸ë˜ë° íŒ¨í„´ì´ë‹¤.
- **GPU í”„ë¡œê·¸ë˜ë°ì€ SIMT í•˜ë“œì›¨ì–´ë¥¼ í™œìš©í•˜ëŠ” SPMD í”„ë¡œê·¸ë˜ë° ìŠ¤íƒ€ì¼ì„ ì‚¬ìš©í•œë‹¤.**

CUDA ì˜ˆì œ:

```c
vector_sum() {
    index;           // ìŠ¤ë ˆë“œ IDë¡œ êµ¬ë¶„
    sum += A[index]; // ê° ìŠ¤ë ˆë“œê°€ ìì‹ ì˜ ì¸ë±ìŠ¤ì— í•´ë‹¹í•˜ëŠ” ìš”ì†Œë¥¼ ë”í•œë‹¤
}
```

ëª¨ë“  ì½”ì–´(ìŠ¤ë ˆë“œ)ê°€ ê°™ì€ `vector_sum()`ì„ ì‹¤í–‰í•˜ë©°, ìŠ¤ë ˆë“œ IDê°€ ê° ìŠ¤ë ˆë“œì˜ ì‘ì—…ì„ êµ¬ë¶„í•œë‹¤.

---

## Lesson 4: GPU ì•„í‚¤í…ì²˜ ì†Œê°œ

### GPU ì•„í‚¤í…ì²˜ ê°œìš”

- ê° ì½”ì–´ëŠ” ì—¬ëŸ¬ ìŠ¤ë ˆë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.
- CPU ì½”ì–´ì— í•´ë‹¹í•˜ëŠ” ê²ƒì„ NVIDIAì—ì„œëŠ” **ìŠ¤íŠ¸ë¦¬ë° ë©€í‹°í”„ë¡œì„¸ì„œ(SM, Streaming Multiprocessor)** ë¼ í•œë‹¤.
- **ìŠ¤íŠ¸ë¦¼ í”„ë¡œì„¸ì„œ(SP)** ëŠ” GPUì˜ ALU ìœ ë‹›ìœ¼ë¡œ, SIMT ë ˆì¸ ë˜ëŠ” ì½”ì–´ë¼ê³ ë„ í•œë‹¤.
- **ë³¸ ê°•ì¢Œì—ì„œ ì½”ì–´ â‰  ìŠ¤íŠ¸ë¦¼ í”„ë¡œì„¸ì„œì´ë‹¤.** CPU ì½”ì–´ì™€ GPU ì½”ì–´ì˜ í˜¼ë™ì„ ì¤„ì´ê¸° ìœ„í•´ SIMT ë ˆì¸ì„ ì½”ì–´ë¼ ë¶€ë¥´ì§€ ì•ŠëŠ”ë‹¤.

í•˜ë‚˜ì˜ SM ë‚´ë¶€ì—ëŠ” ëª…ë ¹ì–´ ìºì‹œ, ë””ì½”ë”, ê³µìœ  ë©”ëª¨ë¦¬, ì—¬ëŸ¬ ìŠ¤íŠ¸ë¦¼ í”„ë¡œì„¸ì„œê°€ í¬í•¨ëœë‹¤.

ğŸ“ **í•™ìŠµ ë¡œê·¸**: [SM, SP, ì›Œí”„ì˜ ê´€ê³„](/log/misc/gpu_architecture/#sm-sp-ì›Œí”„ì˜-ê´€ê³„ "SM â†’ ì›Œí”„ â†’ ìŠ¤ë ˆë“œ â†’ SP ë§¤í•‘ êµ¬ì¡°ì™€ ë²¤ë”ë³„ ìš©ì–´ ì°¨ì´")

### GPU íŒŒì´í”„ë¼ì¸

1. **Fetch** â€” ê° ì‘ì—… í•­ëª©ì„ ì¸ì¶œí•˜ë©°, ë©€í‹°ìŠ¤ë ˆë“œ ì•„í‚¤í…ì²˜ë¥¼ ìœ„í•´ ì—¬ëŸ¬ ë ˆì§€ìŠ¤í„°ë¥¼ ì‚¬ìš©í•œë‹¤.
2. **ìŠ¤ì¼€ì¤„ëŸ¬** â€” ë¼ìš´ë“œ ë¡œë¹ˆ ë˜ëŠ” ìºì‹œ ë¯¸ìŠ¤Â·ë¶„ê¸° ì˜ˆì¸¡ì„ ê³ ë ¤í•˜ëŠ” íƒìš•ì (greedy) ìŠ¤ì¼€ì¤„ëŸ¬ê°€ ìˆë‹¤.
3. **Decode** â€” ì¸ì¶œëœ ëª…ë ¹ì–´ë¥¼ ì²˜ë¦¬í•˜ê³  ë ˆì§€ìŠ¤í„° ê°’ì„ ì½ëŠ”ë‹¤.
4. **ìŠ¤ì½”ì–´ë³´ë”©** â€” ì¤€ë¹„ëœ ì›Œí”„ë¥¼ ì„ íƒí•œë‹¤.
5. **Execute** â€” ì„ íƒëœ ì›Œí”„ê°€ ì‹¤í–‰ ìœ ë‹›ì—ì„œ ì‹¤í–‰ëœë‹¤.
6. **Write-back** â€” ê²°ê³¼ë¥¼ ê¸°ë¡í•œë‹¤.

### ì›Œí”„(Warp) / ì›¨ì´ë¸Œí”„ë¡ íŠ¸(Wave-front)

ë³¸ ê°•ì¢Œì—ì„œ ì›Œí”„ì™€ ì›¨ì´ë¸Œí”„ë¡ íŠ¸ëŠ” ë™ì˜ì–´ë¡œ ì‚¬ìš©ëœë‹¤.

ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ëª¨ì—¬ **ì›Œí”„(warp)** ë˜ëŠ” **ì›¨ì´ë¸Œí”„ë¡ íŠ¸(wave-front)** ë¥¼ í˜•ì„±í•˜ë©°, ì´ê²ƒì´ ì‹¤í–‰ì˜ ê¸°ë³¸ ë‹¨ìœ„ì´ë‹¤. ì›Œí”„ë‹¹ í•˜ë‚˜ì˜ ëª…ë ¹ì–´ê°€ ì¸ì¶œë˜ê³ , í•´ë‹¹ ì›Œí”„ì˜ ëª¨ë“  ìŠ¤ë ˆë“œê°€ ë™ì‹œì— ì‹¤í–‰ëœë‹¤.

- **ì›Œí”„ í¬ê¸°**: ë§ˆì´í¬ë¡œ ì•„í‚¤í…ì²˜ì—ì„œ ë§¤ìš° ì¤‘ìš”í•œ ê°œë…ì´ë‹¤. ì˜¤ë«ë™ì•ˆ **32 ìŠ¤ë ˆë“œ**ë¡œ ìœ ì§€ë˜ì–´ ì™”ìœ¼ë‚˜ ë¯¸ë˜ì— ë³€ê²½ë  ìˆ˜ ìˆë‹¤.
- í”„ë¡œê·¸ë˜ë¨¸ê°€ ì»¤ë„ì— ìŠ¤ë ˆë“œ ìˆ˜ë¥¼ ì§€ì •í•˜ë©´, ìŠ¤ë ˆë“œëŠ” ì›Œí”„ ë‹¨ìœ„ë¡œ ê·¸ë£¹í™”ëœë‹¤.
- ì£¼ì–´ì§„ ëª…ë ¹ì–´ì˜ ì†ŒìŠ¤ í”¼ì—°ì‚°ìê°€ ì¤€ë¹„ë˜ë©´ ì „ì²´ ì›Œí”„ê°€ ì‹¤í–‰ëœë‹¤.

**ì˜ˆì‹œ**: í”„ë¡œê·¸ë˜ë¨¸ê°€ 12ê°œ ìŠ¤ë ˆë“œë¥¼ ì§€ì •í•˜ê³  ì›Œí”„ í¬ê¸°ê°€ 4ì¸ ê²½ìš°, 3ê°œì˜ ì›Œí”„ê°€ êµ¬ì„±ë˜ë©° ê° ì›Œí”„ì˜ 4ê°œ ìŠ¤ë ˆë“œê°€ í•¨ê»˜ ì‹¤í–‰ëœë‹¤.

---

## Lesson 5: GPU ì•„í‚¤í…ì²˜ì˜ ë°œì „ì‚¬

### ì „í†µì ì¸ 3D ê·¸ë˜í”½ìŠ¤ íŒŒì´í”„ë¼ì¸

GPU ë°œì „ì˜ ì£¼ìš” ë‹¨ê³„:

1. **ì „í†µì ì¸ íŒŒì´í”„ë¼ì¸ GPU** â€” ë³„ë„ì˜ ë²„í…ìŠ¤ ì²˜ë¦¬ ìœ ë‹›ê³¼ í”½ì…€ ì²˜ë¦¬ ìœ ë‹›
2. **í”„ë¡œê·¸ë˜ë¨¸ë¸” GPU** â€” ë²„í…ìŠ¤/í”½ì…€ ì…°ì´ë”ë¥¼ ìœ„í•œ í”„ë¡œê·¸ë˜ë¨¸ë¸” ìœ ë‹› ë„ì…
3. **í†µí•© ì…°ì´ë” â†’ GPGPU** â€” ë²„í…ìŠ¤/í”½ì…€ ì…°ì´ë”ê°€ CUDA í”„ë¡œê·¸ë˜ë¨¸ë¸” ì½”ì–´ë¡œ ë°œì „ (Tesla ì•„í‚¤í…ì²˜)
4. **í˜„ëŒ€ GPU** â€” ML ê°€ì†ê¸° ì»´í¬ë„ŒíŠ¸(í…ì„œ ì½”ì–´ ë“±)ì™€ í”„ë¡œê·¸ë˜ë¨¸ë¸” ê¸°ëŠ¥ ì¶”ê°€

ì´ˆê¸° GPUì˜ ì£¼ ì—­í• ì€ ì…ë ¥ëœ 3D í”„ë¦¬ë¯¸í‹°ë¸Œë¥¼ ê¸°í•˜í•™ ì²˜ë¦¬ ë“± ì—¬ëŸ¬ ë‹¨ê³„ë¥¼ ê±°ì³ 2D í”„ë¦¬ë¯¸í‹°ë¸Œë¡œ ë³€í™˜í•˜ê³ , ì´ë¥¼ í™”ë©´ì˜ í”½ì…€ë¡œ ë Œë”ë§í•˜ëŠ” ê²ƒì´ì—ˆë‹¤. ê³ ì • ê¸°ëŠ¥ ì…°ì´ë”ê°€ ì ì°¨ í”„ë¡œê·¸ë˜ë¨¸ë¸”í•˜ê²Œ ë˜ë©´ì„œ **í†µí•© ì…°ì´ë” ì•„í‚¤í…ì²˜**(Tesla ì•„í‚¤í…ì²˜)ê°€ ë“±ì¥í•˜ì˜€ë‹¤. ì´ í˜ì‹ ìœ¼ë¡œ GPUëŠ” ê·¸ë˜í”½ê³¼ ë²”ìš© ì»´í“¨íŒ…ì„ ëª¨ë‘ ì²˜ë¦¬í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤.

GPGPUë¼ëŠ” ìš©ì–´ëŠ” GPUë¥¼ ë²”ìš© ì»´í“¨íŒ…ì— ì‚¬ìš©í•˜ëŠ” ê²ƒì„ êµ¬ë¶„í•˜ê¸° ìœ„í•´ ë„ì…ë˜ì—ˆìœ¼ë‚˜, ì˜¤ëŠ˜ë‚ ì—ëŠ” ì´ êµ¬ë¶„ì´ ë¶ˆí•„ìš”í•´ì¡Œë‹¤.

### í”„ë¡œê·¸ë˜ë¨¸ë¸” GPU ì•„í‚¤í…ì²˜ì˜ ë°œì „

- **ìºì‹œ ê³„ì¸µ êµ¬ì¡°**(L1, L2 ë“±) ë„ì…
- **FP32 â†’ FP64** í™•ì¥ìœ¼ë¡œ HPC ì• í”Œë¦¬ì¼€ì´ì…˜ ì§€ì›
- **ì›ìì (atomic) ì—°ì‚°**ê³¼ ë¹ ë¥¸ ì •ìˆ˜ ì—°ì‚° í†µí•©
- **HBM(High Bandwidth Memory)** í™œìš© â€” GPU ì¹©ê³¼ ë©”ëª¨ë¦¬ì˜ ì§ì ‘ ì—°ê²°ë¡œ ì „ë¡€ ì—†ëŠ” ì „ì†¡ ì†ë„ ì œê³µ
- **ë” ì‘ì€ ë¶€ë™ì†Œìˆ˜ì  í¬ë§·(FP16)** ì§€ì›ìœ¼ë¡œ ML ì—°ì‚° ë³‘ë ¬ì„± í–¥ìƒ
- **í…ì„œ ì½”ì–´** ì±„íƒìœ¼ë¡œ ML ì• í”Œë¦¬ì¼€ì´ì…˜ ê°€ì†
- **íŠ¸ëœìŠ¤í¬ë¨¸ ì½”ì–´** í†µí•©ìœ¼ë¡œ íŠ¸ëœìŠ¤í¬ë¨¸ ML ì›Œí¬ë¡œë“œ ì§€ì›

### NVIDIA H100

NVIDIA GPU ì•„í‚¤í…ì²˜ H100(2023)ì˜ ì£¼ìš” íŠ¹ì§•:

- ë‹¤ì–‘í•œ ì •ë°€ë„ ì§€ì›: FP32, FP64, FP16, INT8, FP8
- í…ì„œ ì½”ì–´ (ì´ì „ ì„¸ëŒ€ ê³„ìŠ¹), ML ì½”ì–´, GPU ì½”ì–´ê°€ í˜„ëŒ€ ML ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ìš”êµ¬ë¥¼ ì¶©ì¡±
- ìƒˆë¡œìš´ **íŠ¸ëœìŠ¤í¬ë¨¸ ì—”ì§„** ë„ì…
- ëŒ€ìš©ëŸ‰ ë ˆì§€ìŠ¤í„° íŒŒì¼ê³¼ **í…ì„œ ë©”ëª¨ë¦¬ ê°€ì†ê¸°(TMA)** ê°œë…
- SM ìˆ˜ì™€ FP ìœ ë‹› ìˆ˜ì˜ ì§€ì†ì  ì¦ê°€
- **NVIDIA NVLink** ìŠ¤ìœ„ì¹˜ ì‹œìŠ¤í…œìœ¼ë¡œ ë‹¤ì¤‘ GPU ì—°ê²°

---

## ì´ ì±•í„°ì—ì„œ ê¸°ì–µí•  ê²ƒ

1. **GPUëŠ” ì²˜ë¦¬ëŸ‰ ì¤‘ì‹¬ ì•„í‚¤í…ì²˜**ì´ë‹¤ â€” CPUëŠ” ì§€ì—° ì‹œê°„, GPUëŠ” ì²˜ë¦¬ëŸ‰ì— ë¯¼ê°í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ëŒ€ìƒìœ¼ë¡œ í•œë‹¤.
2. **SPMD í”„ë¡œê·¸ë˜ë° ëª¨ë¸**ì´ GPUì˜ í•µì‹¬ì´ë‹¤ â€” ê°™ì€ í”„ë¡œê·¸ë¨ì„ ì„œë¡œ ë‹¤ë¥¸ ë°ì´í„°ì— ì ìš©í•˜ë©°, SIMT í•˜ë“œì›¨ì–´ ìœ„ì—ì„œ ì‹¤í–‰ëœë‹¤.
3. **Amdahlì˜ ë²•ì¹™** â€” ì§ë ¬ êµ¬ê°„ì´ 10%ë§Œ ë˜ì–´ë„ ë³‘ë ¬í™”ì˜ ì´ì ì´ í¬ê²Œ ì œí•œëœë‹¤.
4. **ì›Œí”„(warp)** ëŠ” GPU ì‹¤í–‰ì˜ ê¸°ë³¸ ë‹¨ìœ„ì´ë©°, í˜„ì¬ í¬ê¸°ëŠ” 32 ìŠ¤ë ˆë“œì´ë‹¤.
5. **GPU ì•„í‚¤í…ì²˜ëŠ” ì§€ì†ì ìœ¼ë¡œ ì§„í™”**í•œë‹¤ â€” ê³ ì • ê¸°ëŠ¥ ì…°ì´ë” â†’ í”„ë¡œê·¸ë˜ë¨¸ë¸” ì…°ì´ë” â†’ GPGPU â†’ ML ê°€ì†ê¸°(í…ì„œ ì½”ì–´, íŠ¸ëœìŠ¤í¬ë¨¸ ì—”ì§„).

> ì´ ë¬¸ì„œëŠ” Georgia Tech CS8803 GPU Hardware and Software â€” Module 1: Introduction of GPUë¥¼ í•œê¸€ë¡œ ìš”ì•½í•œ ê²ƒì…ë‹ˆë‹¤.
> ì„¸ë¶€ ì‚¬í•­ì€ [ì›ë³¸ ê°•ì˜ ë…¸íŠ¸](https://lowyx.com/posts/gt-gpu-notes/#module-1-introduction-of-gpu)ë¥¼ ì°¸ì¡°í•œë‹¤.
